<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Valerie Johnson">
   <meta name="GENERATOR" content="Mozilla/4.5 [en] (WinNT; I) [Netscape]">
   <title>Engmodel Tutorial</title>
</head>
<body>

<center><b><font size=+2>Engmodel Tutorial</font></b>
<hr WIDTH="50%"></center>
<b><font size=+1>Location of Data Files</font></b>
<br>The sample files used in this tutorial are in /advisor/extras/engmodel/sample_files.&nbsp;
You will use two types of files:
<ol>
<li>
*.txt files:&nbsp; Text files (generated by engine tests) that are processed
by engmodel.&nbsp; The first row is the headings for the columns, and the
data is in columns.</li>

<li>
*.mat files:&nbsp; The test data from the text files saved as a Matlab
mat file with <a href="engmodel_doc.htm#text file">specific names</a> for
the variables to be processed.</li>
</ol>
<b><font size=+1>Overview</font></b>
<br>In this tutorial, you will <a href="#Process Files">process raw data
files and plot the results</a> for an Mercedes 1.7L CI engine and then
<a href="#AdvisorModelGen">generate
an ADVISOR engine file</a>.&nbsp; This engine is available in the ADVISOR
library as FC_CI60_emis.m.&nbsp; Note that the data set processed in this
tutorial includes only a few of the data points used to generate the full
ADVISOR map.
<p>Text to be entered in edit boxes are indicate by <b>bold</b> typeface.&nbsp;
Button pushes on the Engmodel screens are indicated by
<font color="#FF0000">red</font>.&nbsp;
Filenames are <i>italicized</i>.
<p><a NAME="Process Files"></a><b><font size=+1>Process Raw Data Files</font></b>
<br>First, change directories to /advisor/extras/engmodel/sample_files.&nbsp;
If it is not already open, type <b>>> engmodel</b> at the Matlab command
prompt.
<p><b><i>Read in text file</i></b>
<br>Select <font color="#FF0000">Read in text file</font>.&nbsp; Select
<font color="#FF0000">Select
file to convert</font> and choose the file named <i>Mercedes1pt7_sample.txt</i>.&nbsp;
The variables in the header automatically appear in the drop down list.&nbsp;
You need to change them to have the correct names recognized by engmodel.&nbsp;
With the first variable (fc_spd_RPM) selected, <font color="#FF0000">Modify
name</font>.&nbsp; Type in <b>fc_spd</b> and hit <font color="#FF0000">OK</font>.&nbsp;
Note that if you have extra columns in your text file, you can simply 'Delete
from list.'
<p>Either modify all the names in the header list to be the correct names,
or <font color="#FF0000">Select file to convert</font> and choose the file
named <i>Mercedes1pt7_good_headings.txt</i>, which already has the correct
header names.&nbsp; <font color="#FF0000">Select *.mat file to save to</font>
and enter <i>mercedes_17.mat</i>.
<center>
<p><img SRC="tut1.gif" height=328 width=458></center>

<p><b><i>Set Parameters/Process</i></b>
<br>Select <font color="#FF0000">Set Parameters/Process</font>.&nbsp; Select
<font color="#FF0000">Name
of mat file</font> and choose the file named
<i>mercedes_17.mat</i>.&nbsp;
The minimum/maximum speed and torque are automatically set from the limits
of the test data.&nbsp; You can change these if you want to extrapolate
(<a href="engmodel_doc.htm#algorithms">through the chosen algorithm</a>)
beyond your data set.
<center>
<p><img SRC="tut2.gif" height=406 width=642></center>

<p>Change the 'Speed increments (rpm)' to <b>200</b>.&nbsp; Change the
'Lower Heating Value (J/g)' to <b>42937</b>.&nbsp; Ensure that 'Polynomial
Fit' is selected and the 'Plot results?' box is checked, and select <font color="#FF0000">Process</font>.
<p>Seven plots will appear:
<ul>
<li>
5 Maps (g/s)-Fuel, HC, CO, NOx, and PM:&nbsp; The contours plotted are
the generated map points.&nbsp; The test points are plotted with their
values for comparison.</li>

<li>
Fuel use (g/kWh)</li>

<li>
Efficiency Map:&nbsp; The contours plotted are the generated map points.&nbsp;
Again, the test points are plotted with their values for comparison.</li>
</ul>

<center><img SRC="fig1.gif" height=321 width=393><img SRC="fig2.gif" height=316 width=389>
<br><img SRC="fig3.gif" height=317 width=393><img SRC="fig4.gif" height=319 width=392>
<br><img SRC="fig5.gif" height=320 width=392><img SRC="fig6.gif" height=319 width=392>
<br><img SRC="fig7.gif" height=320 width=393></center>

<p>Now try processing the file by extrapolating points based on the 'Nearest
Neighbor' algorithm.&nbsp; Select <font color="#FF0000">Set Parameters/Process</font>.&nbsp;
Change the 'Speed increments (rpm)' to <b>200</b>.&nbsp; Change the 'Lower
Heating Value (J/g)' to <b>42937</b>.&nbsp; Select 'Nearest Neighbor' and
select
<font color="#FF0000">Process</font>.&nbsp; Compare the efficiency
map (below) to the previous map (above).&nbsp; Note that within the range
of the data, the map is unchanged, but in the areas of extrapolation, the
contours have changed.
<center>
<p><img SRC="fig7_nearest.gif" height=316 width=389></center>

<p><a NAME="AdvisorModelGen"></a><b><font size=+1>Generate an ADVISOR Model</font></b>
<br>Once you have processed the data, you can automatically create an ADVISOR
engine file.
<p>The data files used and accuracy/error data from the processing is automatically
saved in the header.&nbsp; You'll need to enter thermal parameters, including
mass of the various engine components.&nbsp; Default scalings based on
the power of the engine are assumed if the information is unknown.
<p>Select <font color="#FF0000">Create ADVISOR File</font>.&nbsp; Fill
in the edit boxes as below:
<center>
<p><img SRC="tut8.gif" height=757 width=660></center>

<p>Select <font color="#FF0000">Make ADVISOR File</font> and you will create
a new file FC_CI60_sample.m.&nbsp; Now you're done and you can add this
to your ADVISOR engine list!
<p><font size=-1>Last revised: 1/26/01, vhj</font>
</body>
</html>
